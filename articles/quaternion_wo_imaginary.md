---
title: "絶対虚数単位を使いたくない人のための四元数表現"
emoji: "🤖"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: [数学]
published: false
---

## はじめに

数学では、自乗すると-1になる数$i$が出てきます。これは存在しない数という意味で、虚数(imaginary number)と呼ばれます。一方、我々が普段使う数は、実際に存在する数という意味で実数(real number)と呼ばれます。そして、実数と虚数が混ざった数を複素数(complex number)といいます。複素数は高次方程式の解を表現するために導入されますが、存在しない数を使うなんて気持ち悪いですよね。そこで、虚数を使わずに、実数だけで話を作ってみましょう。

## 一次方程式

変数$x$の関数、$f(x)$を考えます。これは、$x$を決めたら$f(x)$の値が決まるので、$x$が入力、$f(x)$が出力です。一方、$f(x)$の形と値(出力)が既知である時、その値を与える$x$の値(入力)を知りたいことがよくあります。

例えば、「1冊200円のノートを何冊か買って、1000円だしたらお釣りが200円でした。ノートは何冊買ったでしょう？」といった問題では、$x$を買った冊数、$f(x)$は$x$冊買った場合の価格とすると、

$$
f(x) = 200 x
$$

なので、先程の文章を式に落とすと

$$
1000 - f(x) = 200
$$

となります。これを変形すると

$$
f(x) = 200 x = 800
$$

となります。これは$f(x)$の形と値から$x$を求める、一種の逆問題になっています。

さて、先程の式ですが、$f(x)$の定義を修正して、

$$
f(x) = 200 x - 800
$$

としましょう。すると、我々は

$$
f(x) = 0
$$

を与えるような$x$を求めなさい、という問題に帰着させることができます。これを方程式といいます。以後、適当に定義を修正して、$f(x) = 0$の形の問題のみを考えます。

一般に、実係数$a, b$を使って(ただし$a \neq 0$とする)

$$
f(x) = a x + b = 0
$$

とかけるような方程式を、一次方程式と呼びます。一次方程式の場合、解は

$$
x = -\frac{b}{a}
$$

として求まります。$a$も$b$も実数なので、解$x$も実数です。

## 二次方程式

二次方程式は、実係数$a, b, c$を用いて以下のように表される方程式です(ただし$a \neq 0$)。

$$
f(x) = a x^2 + bx + c = 0
$$

この解を求めるには、以下のように因数分解します。

$$
f(x) = a(x - \alpha)(x - \beta) = 0
$$

3つの項の積が$0$であり、$a \neq 0$ですから、$x - \alpha$もしくは$x - \beta$のどちらかが$0$です。ここから$x = \alpha$もしくは$x = \beta$が解だとわかります。

このように、高次方程式を解くとは、関数$f(x)$を因数分解する問題に帰着されます。

さて、一次方程式の場合は、係数が実数である限り、解も必ず実数でした。しかし、二次方程式では、それでは解が求まらない場合がでてきます。$f(x) = x^2 + 1$とすると、

$$
f(x) = x^2 + 1 = 0
$$

となるため、$x^2 = -1$、すなわち「自乗したら$-1$となる数」を考える必要があります。実数の範囲では解が見つからないため、「解無し」となります。

しかし、なんか工夫して、無理やり解をつくりましょう、というのが本稿の目的です。

## 基底の導入

実数とは、一本の数直線の上に定義された数、すなわち一次元の世界です。一次元の世界では解が見つからないので、二次元の世界を考えることにします。いま、2つの基底$\mathbf{e}_0, \mathbf{e}_1$を考え、これまで$a$と考えていた数は、実は$a \mathbf{e}_0$を省略していたものだ、と考えます。この世界の二次元ベクトル$(a,b)$は、基底を用いて$a \mathbf{e}_0 + b \mathbf{e}_1$と表現できます。


ここで、$(a \mathbf{e}_0 + b \mathbf{e}_1)$というベクトルと$(c \mathbf{e}_0 + d \mathbf{e}_1)$というベクトルの積を考えると、

$$
\begin{aligned}
(a \mathbf{e}_0 + b \mathbf{e}_1)(c \mathbf{e}_0 + d\mathbf{e}_1) &=
ac \mathbf{e}_0 \mathbf{e}_0 +
ad \mathbf{e}_0 \mathbf{e}_1 +
bc \mathbf{e}_1 \mathbf{e}_0 +
bd \mathbf{e}_1 \mathbf{e}_1
\end{aligned}
$$

となります。ここで、基底が満たすべき性質を考えるために、複素数の性質を「カンニング」することにしましょう。$a \mathbf{e}_0 + b \mathbf{e}_1$を、複素数$a+ bi$に対応させることにします。すると、

$$
(a + bi)(c+di) = (ac - bd) + (bc + ad)i
$$

となります。先程、基底で展開した式と比較すると、基底同士の積に以下のようなルールを設ければよいことがわかります。

$$
\begin{aligned}
\mathrm{e}_0 \mathrm{e}_0 &= \mathrm{e}_0\\
\mathrm{e}_0 \mathrm{e}_1 &= \mathrm{e}_1\\
\mathrm{e}_1 \mathrm{e}_0 &= \mathrm{e}_1\\
\mathrm{e}_1 \mathrm{e}_1 &= -\mathrm{e}_1
\end{aligned}
$$

要するに$\mathrm{e}_0$をかけても何も起きず、$\mathrm{e}_1$の自乗は$-\mathrm{e}_0$となるような基底を考えればよいことになります。

これは、行列を用いると

$$
\begin{aligned}
\mathrm{e}_0 &= \begin{pmatrix}
1 & 0 \\ 0 & 1
\end{pmatrix}\\
\mathrm{e}_1 &= \begin{pmatrix}
0 & -1 \\ 1 & 0
\end{pmatrix}
\end{aligned}
$$

と表現できます。$\mathrm{e}_0$は単位行列なのでかけても何もおきず、$\mathrm{e}_1$については

$$
\begin{pmatrix}
0 & -1 \\ 1 & 0
\end{pmatrix}
\begin{pmatrix}
0 & -1 \\ 1 & 0
\end{pmatrix}
=
\begin{pmatrix}
-1 & 0 \\ 0 & -1
\end{pmatrix}
= \mathrm{e}_0
$$

なので、たしかに先程要請した関係式を満たしていることがわかります。

以上から、$\mathrm{e}_1$が虚数単位であり、その行列表現が

$$
\mathrm{e}_1 =
\begin{pmatrix}
0 & -1 \\ 1 & 0
\end{pmatrix}
$$

であることがわかります。

さて、この基底を使うと、例えば

$$
x^2 = -1
$$

という方程式が以下のように解けます。まず、$1$は$\mathrm{e}_0$の略と考えると、

$$
x^2 = - \mathrm{e}_0
$$

となります。ここから、

$$
x = \pm \mathrm{e}_1
$$

と解くことができます。

同様に、

$$
f(x) = x^2 -2x + 2
$$

という関数も

$$
f(x) = x^2 -2x + 2\mathrm{e}_0
$$

としてから、

$$
f(x) = (x -\mathrm{e}_0 - \mathrm{e}_1)(x - \mathrm{e}_0 + \mathrm{e}_1)
$$

と因数分解することができます(積をバラして、基底の積が満たす式を使って簡略化すると、ちゃんと元に戻ることがわかります)。


