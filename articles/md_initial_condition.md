---
title: "分子動力学法でなるべく精密に指定の密度の初期条件を作る方法"
emoji: "🤖"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["Python","MD"]
published: false
---

## 概要

分子動力学法で、原子を指定密度で初期配置したいことがよくあります。適当に配置してしまうとエネルギーが爆発してしまったりするので、なるべく原子同士は離して配置したいですね。ここでは、そんな配置手段の一つとして、格子欠陥のある面心立方格子に組む方法を紹介します。

## 面心立方格子

多くの単純原子が面心立方格子(Face Centered Cubic, FCC)状の固体を持ちます。特に、ネオン、アルゴン、クリプトンといった希ガスの固体がFCCとなります。古典分子動力学法で広く使われているLennard-Jones相互作用は希ガスの分子間力を模したものなので、やはり固体はFCCとなります。まずはなるべく指定の密度に近いFCCを組むコードを組んでみましょう。

簡単のため、シミュレーションボックスは一辺$L$の立方体とします。この中に$N$個原子があるなら、数密度は$\rho = N/L^3$で定義されます。FCCの格子定数を$a$としましょう。系は全ての方向に周期境界条件とし、格子不整合がおきないとします。すなわち、$m=L/a$が整数となる条件を考えます。この系には、単位格子が$m^3$個あります。FCCは単位格子あたり4原子ですから、原子数は$4 m^3$個です。以上から、一辺あたりの格子数$m$と密度の関係は

$$
\rho = \frac{4 m^3}{L^3}
$$

となります。格子欠陥がない場合、指定の密度に最も近い$\rho$を実現するように$m$を選びなさい、という問題になります。

これは先ほどの式を$m$について逆に解けば良いので、

$$
m = \sqrt[3]{\frac{L^3 \rho}{4}}
$$

です。$m$は整数でなければいけませんから、指定の密度にたいして近くなるように切り捨てか切り上げをする必要があります。

