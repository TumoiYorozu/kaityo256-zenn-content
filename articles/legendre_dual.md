---
title: "ルジャンドル変換と双対の話"
emoji: "🤖"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["数学"]
published: false
---

## はじめに

理工系の学生なら、熱力学や解析力学の講義でルジャンドル変換を学んだと思います。ルジャンドル変換は独立変数を取りかえるための変換ですが、これが何をやっているか、どういう意味を持っているかがよくわからに人も多いと思います。幾何学的に見ると、ルジャンドル変換は「点」と「線」を入れ替える双対変換になっています。この双対という考え方はいろんなところに現れます。以下、点と線、点と面の双対変換についてつらつら書いてみたいと思います。

## ルジャンドル変換

関数$y = f(x)$を考えます。これは一価関数であり、上か下に凸で、微分可能な関数であるとしましょう。この関数が表現するものは、$x-y$平面における曲線です。曲線とは点の集合です。二次元空間上の点は、二つのスカラー量の組$(x,y)$で表現することができます。つまり、曲線は、点$(x,y)$の集合、$\{(x,y)\}$として表現できます。

さて、この曲線の、ある点$x_0$における接線$y = a x + b$を考えましょう。ただし、$a = f'(x_0)$、$b = f(x_0) - x f'(x_0)$です。二次元空間上の直線も、傾き$a$と$y$切片$b$という二つのスカラー量で表現することができます。そこで、ある曲線$y=f(x)$上の、ある点$(x,y)$を、その点における接線の係数$(a,b)$で表現することを考えます。

$x_0$を動かしていくと、係数$(a,b)$も変化していきます。曲線が上か下に凸な関数であれば、この曲線の接線を表す集合$\{a,b\}$から、元の曲線を表す点の集合$\{x,y\}$を完全に再現することができます。つまり、ある関数を、「点の集合」ととらえることもできますし、「接線の集合」ととらえることもできます。これがルジャンドル変換です。つまり、ルジャンドル変換とは **「点」から「線」への双対変換** になっています。どちらも二次元ベクトルの集合として表現されているので、情報が落ちない可逆変換になっているのがわかると思います。

ここでは、$(x,y)$を、そこでの接線$y=ax+b$の係数$(a,b)$で表現しましたが、一般には逆変換で負符号がつかないように、$(a, -b)$を採用します。これにより、

$$
\begin{aligned}
x &\rightarrow f'(x) \\
f(x) &\rightarrow x f'(x) - f(x)
\end{aligned}
$$

という変換が導かれます。

多変数関数の場合も、他の変数を固定し、注目する変数での微分、つまり偏微分になるだけで全く同じです。例えば$(q,\dot{q})$の関数ラグランジアン$L(q,\dot{q})$を、$\dot{q}$についてルジャンドル変換すると、先の公式で$x$を$\dot{q}$,$f(x)$を$L$にするだけなので、

$$
\begin{aligned}
\dot{q} &\rightarrow \frac{\partial L}{\partial \dot{q}} \\
L(q,\dot{q}) &\rightarrow \dot{q} \frac{\partial L}{\partial \dot{q}} - L
\end{aligned}
$$

が得られます。ここで$(\dot{q}, L)$をルジャンドル変換して得られた変数の組を$(p,H)$と呼ぶと、

$$
\begin{aligned}
p &=  \frac{\partial L}{\partial \dot{q}}\\
H &= \dot{q} p - L
\end{aligned}
$$

となり、見慣れた変換公式が現れました。変換の幾何学的な意味は、単に$\dot{q}$軸に対して「点を線に」入れ替える変換をしているだけですが、それによって得られるラグランジアンからハミルトニアンへの変換には深い、面白い意味があります。興味のある人は参考書を見てみると良いでしょう。

