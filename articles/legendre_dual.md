---
title: "ルジャンドル変換と双対の話"
emoji: "🤖"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["数学"]
published: true
---

## はじめに

理工系の学生なら、熱力学や解析力学の講義でルジャンドル変換を学んだと思います。ルジャンドル変換は独立変数を取りかえるための変換ですが、これが何をやっているか、どういう意味を持っているかがよくわからに人も多いと思います。幾何学的に見ると、ルジャンドル変換は「点」と「線」を入れ替える双対変換になっています。この双対という考え方はいろんなところに現れます。以下、点と線、点と面の双対変換についてつらつら書いてみたいと思います。

## ルジャンドル変換

関数$y = f(x)$を考えます。これは一価関数であり、上か下に凸で、微分可能な関数であるとしましょう。この関数が表現するものは、$x-y$平面における曲線です。曲線とは点の集合です。二次元空間上の点は、二つのスカラー量の組$(x,y)$で表現することができます。つまり、曲線は、点$(x,y)$の集合、$\{(x,y)\}$として表現できます。

さて、この曲線の、ある点$x_0$における接線$y = a x + b$を考えましょう。ただし、$a = f'(x_0)$、$b = f(x_0) - x f'(x_0)$です。二次元空間上の直線も、傾き$a$と$y$切片$b$という二つのスカラー量で表現することができます。そこで、ある曲線$y=f(x)$上の、ある点$(x,y)$を、その点における接線の係数$(a,b)$で表現することを考えます。

![ルジャンドル変換](https://github.com/kaityo256/zenn-content/blob/main/articles/legendre_dual/legendre.png?raw=true)

$x_0$を動かしていくと、係数$(a,b)$も変化していきます。曲線が上か下に凸な関数であれば、この曲線の接線を表す集合$\{a,b\}$から、元の曲線を表す点の集合$\{x,y\}$を完全に再現することができます。つまり、ある関数を、「点の集合」ととらえることもできますし、「接線の集合」ととらえることもできます。これがルジャンドル変換です。つまり、ルジャンドル変換とは **「点」から「線」への双対変換** になっています。どちらも二次元ベクトルの集合として表現されているので、情報が落ちない可逆変換になっているのがわかると思います。

ここでは、$(x,y)$を、そこでの接線$y=ax+b$の係数$(a,b)$で表現しましたが、一般には逆変換で負符号がつかないように、$(a, -b)$を採用します。これにより、

$$
\begin{aligned}
x &\rightarrow f'(x) \\
f(x) &\rightarrow x f'(x) - f(x)
\end{aligned}
$$

という変換が導かれます。

多変数関数の場合も、他の変数を固定し、注目する変数での微分、つまり偏微分になるだけで全く同じです。例えば$(q,\dot{q})$の関数ラグランジアン$L(q,\dot{q})$を、$\dot{q}$についてルジャンドル変換すると、先の公式で$x$を$\dot{q}$,$f(x)$を$L$にするだけなので、

$$
\begin{aligned}
\dot{q} &\rightarrow \frac{\partial L}{\partial \dot{q}} \\
L(q,\dot{q}) &\rightarrow \dot{q} \frac{\partial L}{\partial \dot{q}} - L
\end{aligned}
$$

が得られます。ここで$(\dot{q}, L)$をルジャンドル変換して得られた変数の組を$(p,H)$と呼ぶと、

$$
\begin{aligned}
p &=  \frac{\partial L}{\partial \dot{q}}\\
H &= \dot{q} p - L
\end{aligned}
$$

となり、見慣れた変換公式が現れました。変換の幾何学的な意味は、単に$\dot{q}$軸に対して「点を線に」入れ替える変換をしているだけですが、それによって得られるラグランジアンからハミルトニアンへの変換には深い、面白い意味があります。興味のある人は参考書、例えば[解析力学1 山本 義隆、中村 孔一 (著)](https://www.amazon.co.jp/dp/4254136714)や[一般力学系と場の幾何学 (大森 英樹、裳華房)](https://www.amazon.co.jp/dp/4785310693) 等を読んでみると良いでしょう。

## パスカルの定理とブリアンションの定理

ルジャンドル変換は、曲線上の点を、その点での接線と入れ替える「点と直線」の双対変換になっていました。この「点と直線」の双対変換でもっとも有名なのはパスカルの定理とブリアンションの定理の関係でしょう。

まず、パスカルの定理とは、「円に内接する六角形の、対面にある辺を延長して得られる三つの交点が一直線上に並ぶ」というものです。

![パスカルの定理](https://github.com/kaityo256/zenn-content/blob/main/articles/legendre_dual/pascal1.png?raw=true)

上記の図では、例えば六角形ABCDEFの、辺ABとEDを延長して得られる交点P、AFとCDをから得られるQ、EFとBCから得られる点Rが一直線上に並んでいます。

さて、この「点と直線」を双対変換で入れ替えてみましょう。

まずは、ABCDEFの各点で、円に対する接線を引きます。すると、円に**外接**する六角形が得られます。

![パスカルの定理2](https://github.com/kaityo256/zenn-content/blob/main/articles/legendre_dual/pascal2.png?raw=true)

得られた六角形の、対面する**点**を結ぶ線を引くと、一点で交わります。これが「ブリアンションの定理」です。

![パスカルの定理3](https://github.com/kaityo256/zenn-content/blob/main/articles/legendre_dual/pascal3.png?raw=true)

ここで、「点」が「直線」に、「直線」が「点」に入れ替わっています。パスカルの定理とブリアンションの定理を並べてみましょう。

![パスカルの定理4](https://github.com/kaityo256/zenn-content/blob/main/articles/legendre_dual/pascal4.png?raw=true)


パスカルの定理においてｍ辺ABを結ぶ直線をα、辺EDを結ぶ直線をδとしましょう。ブリアンションの定理では、α、δはそれぞれ「点」になります。パスカルの定理において「直線」αとδの「交点」Pは、ブリアンションの定理では、「点」αとδを結ぶ「直線」Pになっています。「点P,Q,Rが一直線上θに並ぶ」という命題は、「直線P,Q,Rが一点θで交わる」という命題に変換されます。

このように、お互いに双対の関係にある命題を双対命題と呼びます。幾何学で有名なのはパスカルの定理とブリアンションの定理ですが、他にも論理式で論理和∨と論理積∧、全称記号∀と存在記号∃をそれぞれ入れ替えることで双対命題が得られます。双対命題は真偽が一致します。

## 正多面体

双対変換で面白いのが正多面体の双対です。先ほどまでは「点」と「線」を入れ替えましたが、今度は「点」と「面」を入れ替えてみましょう。

まずその前に正多面体を構築してみましょう。正多面体は、全て正多角形で構成された立体です。例えばサイコロ、つまり正六面体は、全て正方形(正四角形)でできています。正六面体の頂点を見ると、正方形が3つ集まっています。正四面体は正三角形が、頂点に3つ集まっています。このように正多面体は「正$m$角形が各頂点で$n$個接しているもの」と表現できます。これを「$(m,n)$」と表現してみましょう。

まず、$m$として取りえるのは3,4,5だけです。立体を構成するには$n$が3以上でなくてはなりませんが、$m=6$、つまり正六角形を3つ集めると平面になってしまうため、立体が作れません。各$m$の値に対して可能な$n$を列挙し、それでできる正多面体を見てみましょう。

|m|n| 立体 | 
| ---- | ---- | ---- | 
| 3    |   3  | 正四面体 |
| 3    |   4  | 正八面体 |
| 3    |   5  | 正二十面体 |
| 4    |   3  | 正六面体 |
| 5    |   3  | 正十二面体 |
| ---- | ---- | ---- | 

$m$が取りえる値は3,4,5の三種類しかなく、$m=3$の時には$n=3,4,5$が可能ですが、$m=4,5$の時には$n=3$だけが可能です。以上から、正多面体は5種類しかないことが証明できました。

ここで、「面」の中心(重心)を考え、その中心を線で結んでみます。例えば、正六面体の各面の中心を結ぶと、正八面体が出てきます。

![cube](https://github.com/kaityo256/zenn-content/blob/main/articles/legendre_dual/cube.png?raw=true)

先の「各頂点に$m$角形を$n$個集める」ことを$(m,n)$と表現する記法を使うと、正六面体は$(4,3)$、正八面体は$(3,4)$、つまり$m$と$n$を入れ替えた形になっています。つまりお互いに「点」と「面」を入れ替えた双対の関係にあります。

同様にして、正十二面体$(5,3)$と正二十面体$(3,5)$はお互い双対です。ここで正四面体$(3,3)$は、自分自身が双対図形になっています。これを自己双対(self-dual)と呼びます。

正多面体の双対はよく知られていますが、こうして$(m,n)$表記すると「双対とは入れ替えである」ということがわかりやすいかと思います。

## まとめ

ルジャンドル変換は曲線上の接点における接線を考え、「点」の代わりに「線」で曲線を表現する「点」と「線」の双対変換になっています。こういう見方をすると、なぜ$xf'(x) - f(x)$という式が出てくるかがわかりやすいと思います。

なお、ルジャンドル変換は逆変換で負符号が出ないような定義をとることが多いですが、熱力学などでは凸性が入れ替わることを嫌って、逆変換で負符号が出る定義を採用したりします。これもフーリエ変換で片方の変換に$\pi$をつけるか両方に$\sqrt{\pi}$を付けるかと同様、最終的につじつまがあっていれば便利な定義を採用してかまいません。

他にも「点」と「面」をはじめとしていろんな双対があります。実験をする研究室に配属された学生さんは、X線回折などで逆格子が出てくることを学んだでしょう。あれも双対です。

このようにルジャンドル変換や、正多面体、X線回折画像など、一見全くことなるように見えるものに「双対」という共通する見方が存在するのが数学の面白さです。

本稿が「ルジャンドル変換わからん」という学生さんの助けになれば幸いです。

